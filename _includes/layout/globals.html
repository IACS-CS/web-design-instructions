<script>
  /* Populate with content -- we do this in HTML instead of the other JS
   because we need Jekyll to populate our JSON object */
   var sitePages = [
     {% for page in site.pages %}
       {% if page.title %}
         {% if page.url contains 'index.html' %}
           {
             title: '{{ page.title }}',
             url: '{{ page.url | relative_url }}',
             children: [
               {% for child in page.children %}
                 {
                   title: '{{ child.title }}',
                   url: '{{ child.url | relative_url }}',
                 },
               {% endfor %}
             ],
           },
         {% else %}
           {
             title: '{{ page.title }}',
             url: '{{ page.url | relative_url }}',
             order : '{{ page.order }}'
           },
         {% endif %}
       {% endif %}
     {% endfor %}
   ];
  sitePages.sort(function (a, b) {
        // Sort to ensure index/root page comes first
        if (a.url.endsWith("index.md") || a.url[a.url.length - 1] === '/') {
          return -1;
        }
        if (b.url.endsWith("index.md") || b.url[b.url.length - 1] === '/') {
          return 1;
        }
        if (a.order && b.order) {
          return a.order - b.order;
        } else {
          return a.url.localeCompare(b.url); // Optionally, sort remaining pages alphabetically by title
        }
      });
  console.log('Sorted pages are : ',sitePages)
</script>
